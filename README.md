# Effective-Drag-Coefficient-Prediction-on-Single-View-2D-Images
Code for the prediction of the drag coefficient of falling snowflakes given the 2D snowflake image, the shape class, and the Reynolds Number. The model is trained on the Locatelli and Hobbs dataset. Repository contains necessary files to remove the background on the image and process data with the machine learning model to replicate results.

# Data
256res_LH folder contain the Locatelli and Hobbs dataset snowflake images with the background and border removed and cropped, with the image reduced to 256x256 resolution. This change in resolution will make the ML/DL models train faster. LH_pics folder contain the raw images from Locatelli and Hobbs dataset at their original resolution of 3256Ã—2128. This is a very large image, so the resoltion was reduced for 256res_LH. LHDataClean.csv contains all the geometric predictors from the Locatelli and Hobbs dataset as well as the Roll and Pic numbers that are matched to the images in 256res_LH. The files LH_KPCA_1/3/5_highRes.csv are three separate files of KPCA feature extraction, with 1, 3, and 5 features extracted. This is a result of running the files remove_background.py and KPCA.ipynb 


# Use Case
One can replicate the results found in Effective Drag Coefficient Prediction on Single-View 2D-Images paper that used feature extraction algorithm KCPA to extract meaningful features from single-view 2D-images of falling snowflakes. The images are passed through remove_background.py that removes the background and border of the snowflake images. The images are then passed through KPCA.ipynb to extract meaningful features from the images. One can extract a number of features from the snowflake iamges, but 1, 3, and 5 were tested. See Paper for results. One can then pass through the data outputted by KPCA.ipynb to run against machine learning methods: random forest, XGBoost, and MLP models. An ensemble MLP mehtod showed to be the best model with MSE loss. To replicate the results and use the best model, ne can use the script, using_drag_model.py to do drag coefficient prediction on snowflakes. Once the data has been pre-processed with remove_background.py and meaningful features were extracted with KPCA.py, one can use using_drag_model.py now. To run, save script in the folder where the rest of the data is kept and run:

python3 using_drag_model.py ../KPCA_FILE_LOCATION.csv ../RESULT_LOCATION.csv

where KPCA_FILE_LOCATION is the location of the output of the KPCA.py file and RESULT_LOCATION is where you would like to save the KPCA file with the drag coefficient column and prediction data present.
